<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title> - 空白页</title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link rel="shortcut icon" href="favicon.ico">
    <link href="{{contentPath}}/resource/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="{{contentPath}}/resource/css/font-awesome.css?v=4.4.0" rel="stylesheet">
    <link href="{{contentPath}}/resource/styles/github.css" rel="stylesheet">
    <link href="{{contentPath}}/resource/js/plugins/steps/jquery.steps.css" rel="stylesheet">
    <link href="{{contentPath}}/resource/js/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="{{contentPath}}/resource/js/plugins/toastr/toastr.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{contentPath}}/resource/bootstrap.min.css"/>
    <link rel="stylesheet" href="{{contentPath}}/resource/js/plugins/code/lib/codemirror.css"/>
    <link rel="stylesheet" href="{{contentPath}}/resource/js/plugins/code/theme/material-ocean.css"/>
    <!--支持代码折叠-->
    <link rel="stylesheet" href="{{contentPath}}/resource/js/plugins/code/addon/fold/foldgutter.css"/>
    <link rel="stylesheet" href="{{contentPath}}/resource/js/plugins/json2/jquery.json-viewer.css"/>
    <link rel="stylesheet" href="{{contentPath}}/resource/js/plugins/video/video-js.css"/>

    <link href="{{contentPath}}/resource/css/animate.css" rel="stylesheet">
    <link href="{{contentPath}}/resource/css/style.css?v=4.1.0" rel="stylesheet">

    <style>
        #tools {
            position: fixed;
            top: 50px;
            right: 0;
        }

        .hljs .hljs-keyword:first-child {
            margin-left: -197px;
        }

        .hljs .hljs-attr:first-child {
            margin-left: -197px;
        }
    </style>
    <style>
        .CodeMirror {
            border-top: 1px solid black;
            border-bottom: 1px solid black;
        }

        .jsonview .null {
            color: red;
        }

        .jsonview .bool {
            color: #fde3a7;
        }

        .jsonview .num {
            color: #bf55ec;
        }

        .jsonview .string {
            color: #00b16a;
            white-space: pre-wrap;
        }

        /*- scrollbar -*/
        ::-webkit-scrollbar {
            width: 5px;
            height: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #999;
            -webkit-border-radius: 5px;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:vertical:hover {
            background-color: #666;
        }

        ::-webkit-scrollbar-thumb:vertical:active {
            background-color: #030303;
        }

        ::-webkit-scrollbar-button {
            display: none;
        }

        ::-webkit-scrollbar-track {
            background-color: #f1f1f1;
        }

        #tools {
            position: fixed;
            top: 30px;
            right: 0;
        }
    </style>
</head>

<body class="gray-bg">
<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-sm-4">
        <h2>工具</h2>
        <ol class="breadcrumb">
            <li>
                <a href="index.html">工具</a>
            </li>
            <li>
                <strong>格式化</strong>
            </li>
        </ol>

    </div>
</div>

<ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true"> Json 工具</a>
    </li>
    <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false">Xml 工具</a>
    </li>
    <li class=""><a data-toggle="tab" href="#tab-3" aria-expanded="false">JS 工具</a>
    </li>
    <li class=""><a data-toggle="tab" href="#tab-31" aria-expanded="false">Sql 工具</a>
    </li>
    <li class=""><a data-toggle="tab" href="#tab-4" aria-expanded="false">Css 工具</a>
    </li>
    <li class=""><a data-toggle="tab" href="#tab-5" aria-expanded="false">Html 工具</a>
    </li>
    <li class=""><a data-toggle="tab" href="#tab-6" aria-expanded="false">Video 测试工具</a>
    </li>
</ul>
<div class="tab-content" style="height: 95%;">
    <div id="tab-1" class="tab-pane active" style="height: 90%;">
        <div class="panel-body" style="height: 100%;">
            <div id="jsonview" style="height: 100%;width: 100%">
    <textarea id="json" style="width: 40%;height: 100%;float: left;display: block;border: 1px solid #ccc;">
{"_links":{"self":{"href":"http://127.0.0.1:8041/ssp/api/actuator","templated":false},"beans":{"href":"http://127.0.0.1:8041/ssp/api/actuator/beans","templated":false},"caches":{"href":"http://127.0.0.1:8041/ssp/api/actuator/caches","templated":false},"caches-cache":{"href":"http://127.0.0.1:8041/ssp/api/actuator/caches/{cache}","templated":true},"health":{"href":"http://127.0.0.1:8041/ssp/api/actuator/health","templated":false},"health-path":{"href":"http://127.0.0.1:8041/ssp/api/actuator/health/{*path}","templated":true},"info":{"href":"http://127.0.0.1:8041/ssp/api/actuator/info","templated":false},"conditions":{"href":"http://127.0.0.1:8041/ssp/api/actuator/conditions","templated":false},"configprops-prefix":{"href":"http://127.0.0.1:8041/ssp/api/actuator/configprops/{prefix}","templated":true},"configprops":{"href":"http://127.0.0.1:8041/ssp/api/actuator/configprops","templated":false},"env":{"href":"http://127.0.0.1:8041/ssp/api/actuator/env","templated":false},"env-toMatch":{"href":"http://127.0.0.1:8041/ssp/api/actuator/env/{toMatch}","templated":true},"loggers":{"href":"http://127.0.0.1:8041/ssp/api/actuator/loggers","templated":false},"loggers-name":{"href":"http://127.0.0.1:8041/ssp/api/actuator/loggers/{name}","templated":true},"heapdump":{"href":"http://127.0.0.1:8041/ssp/api/actuator/heapdump","templated":false},"threaddump":{"href":"http://127.0.0.1:8041/ssp/api/actuator/threaddump","templated":false},"metrics":{"href":"http://127.0.0.1:8041/ssp/api/actuator/metrics","templated":false},"metrics-requiredMetricName":{"href":"http://127.0.0.1:8041/ssp/api/actuator/metrics/{requiredMetricName}","templated":true},"quartz":{"href":"http://127.0.0.1:8041/ssp/api/actuator/quartz","templated":false},"quartz-jobsOrTriggers":{"href":"http://127.0.0.1:8041/ssp/api/actuator/quartz/{jobsOrTriggers}","templated":true},"quartz-jobsOrTriggers-group":{"href":"http://127.0.0.1:8041/ssp/api/actuator/quartz/{jobsOrTriggers}/{group}","templated":true},"quartz-jobsOrTriggers-group-name":{"href":"http://127.0.0.1:8041/ssp/api/actuator/quartz/{jobsOrTriggers}/{group}/{name}","templated":true},"scheduledtasks":{"href":"http://127.0.0.1:8041/ssp/api/actuator/scheduledtasks","templated":false},"mappings":{"href":"http://127.0.0.1:8041/ssp/api/actuator/mappings","templated":false}}}
    </textarea>
                <div style="width:18%; height: 100%;float: left">
                    <button style="width:calc(100% - 20px);float: left;margin: 10px;" class="btn btn-primary"
                            id="formatter-btn">
                        格式化
                    </button>
                    <label style="width:calc(100% - 20px);float: left; display: block; margin: 10px;"
                           class="checkbox-inline">
                        <input type="checkbox" id="with-quotes">
                        为Key添加双引号
                    </label>
                </div>
                <div id="json-collapsed"
                     style="overflow: auto;width: 40%;height: 100%;float: left;border: 1px solid #ccc;"></div>
            </div>
        </div>
    </div>
    <div id="tab-2" class="tab-pane" style="height: 90%;">
        <div class="panel-body" style="height: 100%;">
             <textarea id="xml" style="width: 40%;height: 100%;float: left;display: block;border: 1px solid #ccc;">
<?xml version="1.0" encoding="utf-8"?><example version="2.0"><head><title>Original Title</title></head><body><element message="Greeting" title="Chapter1"><element message="We say good morning in the morning."></element><element message="We say hello at noon."/><element message="We say good evening at night."/></element><element message="Thank" title="Chapter2"><element>value</element><element></element></element></body></example>    </textarea>
            <div style="width:18%; height: 100%;float: left">
                <button style="width:calc(100% - 20px);float: left;margin: 10px;" class="btn btn-primary"
                        id="xml-formatter-btn">
                    格式化
                </button>
            </div>
            <textarea id="xml-collapsed" readonly disabled
                      style="overflow: auto;display: block;width: 40%;height: 100%;float: left;"></textarea>
        </div>
    </div>
    <div id="tab-3" class="tab-pane" style="height: 90%;">
        <div class="panel-body" style="height: 100%;">
             <textarea id="js" style="width: 40%;height: 100%;float: left;display: block;border: 1px solid #ccc;">
(function(i, s, o, g, r, a, m) {i['GoogleAnalyticsObject'] = r;i[r] = i[r] || function() {(i[r].q = i[r].q || []).push(arguments)}, i[r].l = 1 * new Date();a = s.createElement(o),m = s.getElementsByTagName(o)[0];a.async = 1;a.src = g;m.parentNode.insertBefore(a, m) })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
             </textarea>
            <div style="width:18%; height: 100%;float: left">
                <button style="width:calc(100% - 20px);float: left;margin: 10px;" class="btn btn-primary"
                        id="js-formatter-btn">
                    格式化
                </button>
            </div>
            <textarea id="js-collapsed" readonly disabled
                      style="overflow: auto;display: block;width: 40%;height: 100%;float: left;"></textarea>
        </div>
    </div>
    <div id="tab-4" class="tab-pane" style="height: 90%;">
        <div class="panel-body" style="height: 100%;">
             <textarea id="css" style="width: 40%;height: 100%;float: left;display: block;border: 1px solid #ccc;">
body {background: #eee;color: #333;height: 95vh;font: 13px/1.231 arial, sans-serif; } a.self {font-weight: bold;text-decoration: none;color: #444;border-bottom: 1px solid #aaa } h1.logo {display: flex;line-height: 1em;margin: 0; }
             </textarea>
            <div style="width:18%; height: 100%;float: left">
                <button style="width:calc(100% - 20px);float: left;margin: 10px;" class="btn btn-primary"
                        id="css-formatter-btn">
                    格式化
                </button>
            </div>
            <textarea id="css-collapsed" readonly disabled
                      style="overflow: auto;display: block;width: 40%;height: 100%;float: left;"></textarea>
        </div>
    </div>
    <div id="tab-31" class="tab-pane" style="height: 90%;">
        <div class="panel-body" style="height: 100%;">
             <textarea id="sql" style="width: 40%;height: 100%;float: left;display: block;border: 1px solid #ccc;">
 SELECT org_name,sum(comprehensive_ec) as comprehensive_year,sum(ec_progress) as ec_progress from energy_consumption where `year` = (SELECT max(year) from energy_consumption) and `month` = (SELECT max(`month`) from energy_consumption)  GROUP BY org_name ORDER BY comprehensive_year desc             </textarea>
            <div style="width:18%; height: 100%;float: left">
                <button style="width:calc(100% - 20px);float: left;margin: 10px;" class="btn btn-primary"
                        id="sql-formatter-btn">
                    格式化
                </button>
            </div>
            <textarea id="sql-collapsed" readonly disabled
                      style="overflow: auto;display: block;width: 40%;height: 100%;float: left;"></textarea>
        </div>
    </div>
    <div id="tab-5" class="tab-pane" style="height: 90%;">
        <div class="panel-body" style="height: 100%;">
             <textarea id="html" style="width: 40%;height: 100%;float: left;display: block;border: 1px solid #ccc;">
<div class="panel-body" style="height: 100%;"><button style="width:calc(100% - 20px);float: left;margin: 10px;" class="btn btn-primary" id="html-formatter-btn">格式化</button><div style="width:18%; height: 100%;float: left"><button style="width:calc(100% - 20px);float: left;margin: 10px;" class="btn btn-primary" id="html-formatter-btn">格式化</button></div></div>
             </textarea>
            <div style="width:18%; height: 100%;float: left">
                <button style="width:calc(100% - 20px);float: left;margin: 10px;" class="btn btn-primary"
                        id="html-formatter-btn">
                    格式化
                </button>
            </div>
            <textarea id="html-collapsed" readonly disabled
                      style="overflow: auto;display: block;width: 40%;height: 100%;float: left;"></textarea>
        </div>
    </div>
    <div id="tab-6" class="tab-pane" style="height: 90%;">
        <div class="panel-body" style="height: 100%; position: relative">
            <form class="form-inline" id="video-m3u8-events">
                <div class="form-group">
                    <input id="video-m3u8" class="form-control pull-left"/>
                    <div id="video-m3u8-event" class="btn btn-primary pull-left">测试</div>
                </div>
                <div class="form-group">
                    <select class="input-sm form-control input-s-sm inline">
                        <option value="0">请选择</option>
                        <option value="m3u8">m3u8</option>
                        <option value="ws">ws</option>
                        <option value="hls">hls</option>
                    </select>
                </div>
            </form>

            <video id="welcomeVideo" class="video-js vjs-default-skin" style="top: 80px; width: 100%; height: 88%;"/>
        </div>
    </div>
</div>

<script>
</script>
<!-- 全局js -->
<script src="{{contentPath}}/resource/js/jquery.min.js?v=2.1.4"></script>
<script src="{{contentPath}}/resource/js/bootstrap.min.js?v=3.3.6"></script>

<!-- 自定义js -->
<script src="{{contentPath}}/resource/js/content.js?v=1.0.0"></script>
<script src="{{contentPath}}/resource/lib/highlight.pack.js" type="text/javascript"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="{{contentPath}}/resource/lib/sql-formatter.min.js" type="text/javascript"></script>

<!-- Peity -->
<script src="{{contentPath}}/resource/js/plugins/peity/jquery.peity.min.js"></script>
<script src="{{contentPath}}/resource/js/plugins/steps/jquery.steps.min.js"></script>
<script src="{{contentPath}}/resource/js/plugins/iCheck/icheck.min.js"></script>
<script src="{{contentPath}}/resource/js/plugins/toastr/toastr.min.js"></script>
<script src="{{contentPath}}/resource/js/plugins/beautify/beautifier.min.js"></script>
<script src="{{contentPath}}/resource/js/plugins/beautify/beautify-css.min.js"></script>
<script src="{{contentPath}}/resource/js/plugins/beautify/beautify-html.min.js"></script>
<script src="{{contentPath}}/resource/js/plugins/beautify/beautify-xml.js"></script>

<script src="{{contentPath}}/resource/js/plugins/code/lib/codemirror.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/code/lib/formatting.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/json2/json2.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/json2/jsonlint.js" type="text/javascript"></script>
<!--<script src="{{contentPath}}/resource/js/plugins/code/mode/groovy/groovy.js" type="text/javascript"></script>-->
<!--<script src="{{contentPath}}/resource/js/plugins/code/mode/clike/clike.js" type="text/javascript"></script>-->
<script src="{{contentPath}}/resource/js/plugins/code/mode/http/http.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/code/mode/json/json.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/code/mode/javascript/javascript.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/code/mode/html/html.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/code/mode/css/css.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/code/mode/xml/xml.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/code/mode/sql/sql.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/json2/jquery.json-viewer.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/video/video.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/video/videojs-contrib-hls.min.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/js/plugins/video/hls.min.js" type="text/javascript"></script>
<script src="{{contentPath}}/resource/lib/sql-formatter.min.js" type="text/javascript"></script>

<!--<script src="{{contentPath}}/resource/js/plugins/code/addon/fold/foldcode.js"></script>-->
<!--<script src="{{contentPath}}/resource/js/plugins/code/addon/fold/foldgutter.js"></script>-->
<!--<script src="{{contentPath}}/resource/js/plugins/code/addon/fold/brace-fold.js"></script>-->
<!--<script src="{{contentPath}}/resource/js/plugins/code/addon/fold/comment-fold.js"></script>-->

<script>
    $(function () {
        $('#video-m3u8-event').on('click', function () {
            if (0 == $('#video-m3u8-events').next('video').length) {
                $('#video-m3u8-events').after(`<video id="welcomeVideo" class="video-js vjs-default-skin" style="top: 80px; width: 100%; height: 88%;" />`);
            }
            let _selected = $('#video-m3u8-events select > option:selected').val();
            let _url = $('#video-m3u8').val();
            $('#welcomeVideo').empty();
            if ('m3u8' == _selected) {
                $('#welcomeVideo').append(`<source id="video-m3u8-source" src="${_url}" type="application/x-mpegURL" />`)
                if (!!window.myVideo) {
                    try {
                        window.myVideo.dispose();
                        window.myVideo = null;
                    } catch (e) {
                    }
                }
                window.myVideo = videojs('welcomeVideo', {
                    loop: true,
                    controls: false,
                    preload: 'auto',
                    autoplay: true
                });
            } else if ('hls' == _selected) {
                let video = document.getElementById("welcomeVideo");
                var hls = new Hls();
                var hlsUrl = _url;
                hls.loadSource(hlsUrl);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, function () {
                    video.play();
                });
            } else if ('ws' == _selected) {
                function sockets(buffer) {
                    const socket = new WebSocket(_url)
                    socket.onmessage = async function (event) {
                        buffer.appendBuffer(new Uint8Array(event.data))
                    }
                }

                let ms = new MediaSource()
                let output = document.getElementById('welcomeVideo')
                output.src = URL.createObjectURL(ms)
                ms.onsourceopen = () => {
                    let buffer = ms.addSourceBuffer('video/webm; codecs="vorbis,vp8"')
                    sockets(buffer)
                }
            }
        });

        $('#sql-formatter-btn').on('click', function () {
            let beautifier1 = sqlFormatter.format($('#sql').val());
            var editor = CodeMirror.fromTextArea(document.getElementById("sql-collapsed"), {
                mode: "text/x-sparksql",
                indentUnit: 4,             // 缩进单位为4
                indentWithTabs: true,     //
                smartIndent: true,        //自动缩进，设置是否根据上下文自动缩进（和上一行相同的缩进量）。默认为true。
                styleActiveLine: true,       // 当前行背景高亮
                lineNumbers: true,        //是否在编辑器左侧显示行号
                matchBrackets: true,      // 括号匹配
            });
            editor.setSize('40%', '100%'); //设置代码框大小
            editor.setValue(beautifier1);
        });
        $('#html-formatter-btn').on('click', function () {
            let beautifier1 = beautifier.html($('#html').val(), {});
            var editor = CodeMirror.fromTextArea(document.getElementById("html-collapsed"), {
                mode: 'html',
                indentUnit: 4,             // 缩进单位为4
                indentWithTabs: true,     //
                smartIndent: true,        //自动缩进，设置是否根据上下文自动缩进（和上一行相同的缩进量）。默认为true。
                styleActiveLine: true,       // 当前行背景高亮
                lineNumbers: true,        //是否在编辑器左侧显示行号
                matchBrackets: true,      // 括号匹配
            });
            editor.setSize('40%', '100%'); //设置代码框大小
            editor.setValue(beautifier1);
        });
        $('#css-formatter-btn').on('click', function () {
            let beautifier1 = beautifier.css($('#css').val(), {});
            var editor = CodeMirror.fromTextArea(document.getElementById("css-collapsed"), {
                mode: 'css',
                indentUnit: 4,             // 缩进单位为4
                indentWithTabs: true,     //
                smartIndent: true,        //自动缩进，设置是否根据上下文自动缩进（和上一行相同的缩进量）。默认为true。
                styleActiveLine: true,       // 当前行背景高亮
                lineNumbers: true,        //是否在编辑器左侧显示行号
                matchBrackets: true,      // 括号匹配
            });
            editor.setSize('40%', '100%'); //设置代码框大小
            editor.setValue(beautifier1);
        });
        $('#js-formatter-btn').on('click', function () {
            let beautifier1 = beautifier.js($('#js').val(), {});
            var editor = CodeMirror.fromTextArea(document.getElementById("js-collapsed"), {
                mode: 'javascript',
                indentUnit: 4,             // 缩进单位为4
                indentWithTabs: true,     //
                smartIndent: true,        //自动缩进，设置是否根据上下文自动缩进（和上一行相同的缩进量）。默认为true。
                styleActiveLine: true,       // 当前行背景高亮
                lineNumbers: true,        //是否在编辑器左侧显示行号
                matchBrackets: true,      // 括号匹配
            });
            editor.setSize('40%', '100%'); //设置代码框大小
            editor.setValue(beautifier1);
        });
        $('#xml-formatter-btn').on('click', function () {
            //$("#json").JSONView();
            var input = $('#xml').val();
            const beautifiedXmlText = new XmlBeautify().beautify(input);
            let split = beautifiedXmlText.split('\n');
            let $xmlCollapsed = $("#xml-collapsed");
            // for(let index in split) {
            //     let item = split[index];
            //     let blank = getBlankLength(item);
            //     $xmlCollapsed.append(`<div style="margin-left: ${blank * 2}px">${item}</div>`);
            // }
            //根据DOM元素的id构造出一个编辑器
            var editor = CodeMirror.fromTextArea(document.getElementById("xml-collapsed"), {
                mode: 'xml',
                indentUnit: 4,             // 缩进单位为4
                indentWithTabs: true,     //
                smartIndent: true,        //自动缩进，设置是否根据上下文自动缩进（和上一行相同的缩进量）。默认为true。
                styleActiveLine: true,       // 当前行背景高亮
                lineNumbers: true,        //是否在编辑器左侧显示行号
                matchBrackets: true,      // 括号匹配
            });
            editor.setSize('40%', '100%'); //设置代码框大小
            editor.setValue(beautifiedXmlText);
            //    $xmlCollapsed.text(beautifiedXmlText);
        });

        const getBlankLength = function (item) {
            let split = item.split(' ');
            let index = 0;
            for (let item of split) {
                if ("" === item) {
                    index++;
                    continue
                }
                return index;
            }
            return index;
        }

        $('#formatter-btn').on('click', function () {
            //$("#json").JSONView();
            var input;
            try {
                input = eval('(' + $('#json').val() + ')');
            } catch (error) {
                return alert("Cannot eval JSON: " + error);
            }
            let jsonEdit = $("#json-collapsed").jsonViewer(input, {
                collapsed: false,
                nl2br: true,
                withQuotes: $('#with-quotes').is(':checked'),
                recursive_collapser: true,
                key_marks: true,
                link_marks: true
            });
            console.log(jsonEdit);
        });

    });

</script>
</body>

</html>
